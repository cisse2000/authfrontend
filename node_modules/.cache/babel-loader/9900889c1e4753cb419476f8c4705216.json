{"ast":null,"code":"import Vue from 'vue';\nimport Vuex from 'vuex';\nimport ApiService from '@/services/ApiService';\nVue.use(Vuex);\nexport default new Vuex.Store({\n  state: {\n    isLoading: false,\n    isAuthenticated: false,\n    accessToken: null,\n    refreshToken: null,\n    // Les données\n    user: null,\n    fileData: null,\n    postData: null,\n    posts: null,\n    post: null\n  },\n  getters: {\n    loggedIn(state) {\n      return state.accessToken != null;\n    },\n\n    accessToken(state) {\n      return state.accessToken;\n    }\n\n  },\n  mutations: {\n    setFileData(state, data) {\n      state.fileData = data;\n    },\n\n    initializeStore(state) {\n      if (localStorage.getItem('accessToken')) {\n        state.accessToken = localStorage.getItem('accessToken'), state.refreshToken = localStorage.getItem('refreshToken'), state.isAuthenticated = true;\n      } else {\n        state.accessToken = null, state.isAuthenticated = false;\n      }\n    },\n\n    updateStorage(state, {\n      access,\n      refresh\n    }) {\n      state.accessToken = access;\n      state.refreshToken = refresh;\n      state.isAuthenticated = true;\n    },\n\n    destroyToken(state) {\n      state.accessToken = null, state.refreshToken = null, state.isAuthenticated = false;\n      localStorage.removeItem('accessToken');\n      localStorage.removeItem('refreshToken');\n      localStorage.removeItem('username');\n      localStorage.removeItem('userid');\n    },\n\n    setIsLoading(state, status) {\n      state.isLoading = status;\n    }\n\n  },\n  actions: {\n    userLogout(context) {\n      if (context.getters.loggedIn) {\n        context.commit('destroyToken');\n      }\n    },\n\n    userLogin(context, userCredentials) {\n      return new Promise((resolve, reject) => {\n        let service = new ApiService();\n        service.add('/jwt/create/', {\n          email: userCredentials.username,\n          password: userCredentials.password\n        }).then(response => {\n          context.commit('updateStorage', {\n            access: response.data.access,\n            refresh: response.data.refresh\n          });\n          resolve();\n        }).catch(error => {\n          reject(error);\n        });\n      });\n    }\n\n  },\n  modules: {}\n});","map":{"version":3,"names":["Vue","Vuex","ApiService","use","Store","state","isLoading","isAuthenticated","accessToken","refreshToken","user","fileData","postData","posts","post","getters","loggedIn","mutations","setFileData","data","initializeStore","localStorage","getItem","updateStorage","access","refresh","destroyToken","removeItem","setIsLoading","status","actions","userLogout","context","commit","userLogin","userCredentials","Promise","resolve","reject","service","add","email","username","password","then","response","catch","error","modules"],"sources":["/home/oumar/projets/auth/frontend/src/store/index.js"],"sourcesContent":["import Vue from 'vue'\nimport Vuex from 'vuex'\nimport ApiService from '@/services/ApiService'\n\nVue.use(Vuex)\n\nexport default new Vuex.Store({\n  state: {\n    isLoading: false,\n    isAuthenticated: false,\n    accessToken: null,\n    refreshToken: null,\n    \n    // Les données\n    user: null,\n    fileData: null,\n    postData: null,\n    posts: null,\n    post : null\n  \n  },\n  getters: {\n    loggedIn(state){\n      return state.accessToken != null\n    },\n\n    accessToken(state){\n      return state.accessToken\n    }\n  },\n  mutations: {\n    setFileData(state, data){\n      state.fileData = data\n    },\n\n    initializeStore(state){\n      if(localStorage.getItem('accessToken')){\n        state.accessToken = localStorage.getItem('accessToken'),\n        state.refreshToken = localStorage.getItem('refreshToken'),\n        state.isAuthenticated = true\n\n      } else {\n        state.accessToken = null,\n        state.isAuthenticated = false\n        \n      }\n    },\n\n    updateStorage(state, {access, refresh}){\n      state.accessToken = access\n      state.refreshToken = refresh\n      state.isAuthenticated = true\n    },\n\n    destroyToken(state){\n      state.accessToken = null,\n      state.refreshToken = null,\n      state.isAuthenticated = false\n      localStorage.removeItem('accessToken')\n      localStorage.removeItem('refreshToken')\n      localStorage.removeItem('username')\n      localStorage.removeItem('userid')\n    },\n    setIsLoading(state, status){\n      state.isLoading = status\n    },\n  },\n  actions: {\n    userLogout(context){\n      if(context.getters.loggedIn){\n        context.commit('destroyToken')\n\n      }\n    },\n    userLogin(context, userCredentials){\n      \n      return new Promise((resolve, reject) => {\n\n        let service = new ApiService()\n        service.add('/jwt/create/',{\n          email: userCredentials.username,\n          password: userCredentials.password\n        })\n        .then(response => {\n          context.commit('updateStorage', { access: response.data.access, refresh: response.data.refresh})\n          resolve()\n        })\n        .catch(error => {\n          reject(error)\n        })\n        \n        \n      })\n    }\n\n    \n\n  },\n  modules: {\n  }\n  \n})\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}