{"ast":null,"code":"import ApiService from '@/services/ApiService';\nimport { mapState } from 'vuex';\nexport default {\n  name: 'Posts',\n\n  created() {\n    this.get_posts();\n  },\n\n  computed: mapState(['posts']),\n  data: () => ({\n    valid: true,\n    show: false,\n    search: '',\n    //Les buttons de navigation\n    showNextButton: false,\n    showPreviosButton: false,\n    currentPage: 1,\n    items: [{\n      text: 'Accueil',\n      disabled: false,\n      href: {\n        name: 'home'\n      }\n    }, {\n      text: 'Profile',\n      disabled: false,\n      href: {\n        name: 'profile'\n      }\n    }, {\n      text: 'Liste de Posts',\n      disabled: false,\n      href: {\n        name: 'addFile'\n      }\n    }]\n  }),\n  methods: {\n    gotoNextPage() {\n      this.currentPage += 1;\n      this.get_posts();\n    },\n\n    gotoPreviousPage() {\n      this.currentPage -= 1;\n      this.get_posts();\n    },\n\n    SearchForm() {\n      this.get_posts();\n    },\n\n    async get_posts() {\n      this.$store.commit('setIsLoading', true);\n      this.showNextButton = false;\n      this.showPreviosButton = false;\n      let apiAxios = new ApiService();\n      await apiAxios.find(`/posts/?page=${this.currentPage}&search=${this.search}`).then(response => {\n        this.$store.state.posts = response.data.results;\n        console.log(this.$store.state.posts);\n        if (response.data.previous) this.showPreviosButton = true;\n        if (response.data.next) this.showNextButton = true;\n      }).catch(error => {\n        console.log(error);\n      });\n      this.$store.commit('setIsLoading', false);\n    },\n\n    supprimer(id) {\n      let apiAxios = new ApiService();\n      apiAxios.delete(`/posts/${id}/`, id).then(response => {\n        // this.$store.state.posts = response.data\n        console.log(this.$store.state.posts);\n        this.get_posts();\n      }).catch(error => {\n        console.log(error);\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAiGA;AACA;AACA;EACAA,aADA;;EAEAC;IACA;EACA,CAJA;;EAKAC,6BALA;EAMAC;IACAC,WADA;IAEAC,WAFA;IAGAC,UAHA;IAKA;IACAC,qBANA;IAOAC,wBAPA;IAQAC,cARA;IAWAC,QACA;MACAC,eADA;MAEAC,eAFA;MAGAC;QAAAb;MAAA;IAHA,CADA,EAMA;MACAW,eADA;MAEAC,eAFA;MAGAC;QAAAb;MAAA;IAHA,CANA,EAWA;MACAW,sBADA;MAEAC,eAFA;MAGAC;QAAAb;MAAA;IAHA,CAXA;EAXA,EANA;EAsCAc;IACAC;MACA;MACA;IACA,CAJA;;IAKAC;MACA;MACA;IACA,CARA;;IAUAC;MACA;IACA,CAZA;;IAeA;MACA;MACA;MACA;MAEA;MACA,eACAC,IADA,CACA,wDADA,EAEAC,IAFA,CAEAC;QACA;QACAC;QAEA;QACA;MAEA,CATA,EAUAC,KAVA,CAUAC;QACAF;MACA,CAZA;MAcA;IACA,CApCA;;IAqCAG;MAEA;MACAC,qCACAN,IADA,CACAC;QACA;QACAC;QAEA;MAEA,CAPA,EAQAC,KARA,CAQAC;QACAF;MACA,CAVA;IAWA;;EAnDA;AAtCA","names":["name","created","computed","data","valid","show","search","showNextButton","showPreviosButton","currentPage","items","text","disabled","href","methods","gotoNextPage","gotoPreviousPage","SearchForm","find","then","response","console","catch","error","supprimer","apiAxios"],"sourceRoot":"src/views/posts","sources":["Posts.vue"],"sourcesContent":["<template>\n    <div id=\"file\">\n        <v-container>\n                       <!-- Breadcrud -->\n            <template>\n                <div>\n                    <v-breadcrumbs :items=\"items\">\n                    <template v-slot:divider>\n                        <v-icon>mdi-chevron-right</v-icon>\n                    </template>\n                    </v-breadcrumbs>\n                </div>\n            </template>\n            <!-- Breadcrumb -->\n\n            <div class=\" d-flex \">\n            \n                <router-link color=\"\" class=\"ma-10 mb-5\" :to=\"{name: 'addPost' }\">Ajouter</router-link>\n                <form @keyup.prevent=\"SearchForm\" class=\"ma-10 mt-4 mx-auto\">\n                    <v-text-field\n                        v-model=\"search\"\n                        label=\"Rechercher un par nom\"\n                    ></v-text-field>\n                </form>\n\n            </div>\n\n            <h1 class=\"ma-5\">Liste des fichiers</h1>\n            <v-row class=\"d-flex justify-content\">\n                <!-- <v-col cols=\"6\" md=\"6\" > -->\n                    \n                <div v-for=\"item in posts\" :key=\"item.id\">\n                    \n                    <template>\n                        <v-card\n                            class=\" ma-5\"\n                            max-width=\"300\"\n                        >\n                            <v-img\n                            class=\"white--text align-end\"\n                            height=\"200px\"\n                            :src=\"item.image\"\n                            >\n                            <v-card-title>{{item.title}}</v-card-title>\n                            </v-img>\n\n                            <!-- Fait par - {{item.created_by.last_name}} -->\n                            <v-card-subtitle class=\"pb-0\">\n                            </v-card-subtitle>\n\n                            <v-card-text class=\"text--primary\">\n                            <div>{{item.title}}</div>\n\n                            <div>{{item.content}}</div>\n                            </v-card-text>\n\n                            <v-card-actions>\n                            <v-btn\n                                color=\"orange\"\n                                text\n                                :to=\"{name: 'showPost', params:{'id': item.id } }\"\n                            >\n                                Voir\n                            </v-btn>\n\n                            <v-btn\n                                color=\"primary\"\n                                text\n                                :to=\"{name: 'editPost', params:{'id': item.id } }\"\n                            >\n                                Modifier\n                            </v-btn>\n\n                            <v-btn\n                                color=\"red\"\n                                text\n                                @click=\"supprimer(item.id)\"\n                            >\n                                Suprimer\n                            </v-btn>\n                            </v-card-actions>\n                        </v-card>\n                    </template>\n\n                </div>\n        \n            </v-row>\n            <div class=\"buttons ma-10 grey\">\n                <button @click=\"gotoNextPage\" class=\"button mt-2 mx-2 is-light\" v-if=\"showNextButton\">Suivant</button>\n                <button @click=\"gotoPreviousPage\" class=\"button mt-2 mx-2 is-light\" v-if=\"showPreviosButton\">Précédant</button>\n            </div>\n                            \n        </v-container>\n    </div>\n</template>\n\n<script>\nimport ApiService from '@/services/ApiService'\nimport {mapState} from 'vuex'\n    export default {\n        name: 'Posts',\n        created(){\n          this.get_posts()\n        },\n        computed: mapState(['posts']),\n        data:() => ({\n            valid: true,\n            show: false,\n            search: '',\n\n            //Les buttons de navigation\n            showNextButton: false,\n            showPreviosButton: false,\n            currentPage: 1,\n            \n           \n            items: [\n                {\n                text: 'Accueil',\n                disabled: false,\n                href: {name: 'home'},\n                },\n                {\n                text: 'Profile',\n                disabled: false,\n                href: {name: 'profile'},\n                },\n                {\n                text: 'Liste de Posts',\n                disabled: false,\n                href: {name: 'addFile'},\n                },\n            ],\n\n            \n        }),\n\n        methods: {\n            gotoNextPage(){\n                this.currentPage += 1\n                this.get_posts()\n            },\n            gotoPreviousPage(){\n                this.currentPage -= 1\n                this.get_posts()\n            },\n\n            SearchForm(){\n                this.get_posts()\n            },\n\n\n            async get_posts(){\n                this.$store.commit('setIsLoading', true);\n                this.showNextButton = false\n                this.showPreviosButton = false\n\n                let apiAxios = new ApiService()\n                await apiAxios\n                .find(`/posts/?page=${this.currentPage}&search=${this.search}`)\n                .then(response => {\n                    this.$store.state.posts = response.data.results\n                    console.log(this.$store.state.posts) \n\n                    if(response.data.previous) this.showPreviosButton = true\n                    if(response.data.next) this.showNextButton = true\n                    \n                })\n                .catch(error => {\n                    console.log(error)\n                })\n\n                this.$store.commit('setIsLoading', false);\n            },\n            supprimer(id){\n                \n                let apiAxios = new ApiService()\n                apiAxios.delete(`/posts/${id}/`, id)\n                .then(response => {\n                    // this.$store.state.posts = response.data\n                    console.log(this.$store.state.posts) \n                    \n                    this.get_posts()\n                    \n                })\n                .catch(error => {\n                    console.log(error)\n                })\n            }\n        }\n        \n    }\n</script>\n\n<style lang=\"scss\" scoped>\n\n</style>"]},"metadata":{},"sourceType":"module"}